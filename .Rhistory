scale_size_continuous("Sample size",range=c(2,8))+
scale_edge_colour_manual(values = COL)+
scale_colour_manual(values = COL)+
theme_void() + theme(legend.position = "right",legend.direction = "vertical") + guides(colour = "none", edge_colour ="none")  + coord_fixed())
db_full <- db_full[db_full$Remove != "yes",] ; db_full <- droplevels(db_full)
db_full <- db_full[db_full$System != "Anchialine/Marine",] ; db_full <- droplevels(db_full)
db_full <- db_full[db_full$System != "Groundwater",] ; db_full <- droplevels(db_full)
db_full <- db_full[db_full$Conservation_Group != "Education",] ; db_full <- droplevels(db_full)
db_full <- db_full[db_full$Conservation_Group != "Assessment",] ; db_full <- droplevels(db_full)
db_full <- db_full[db_full$Conservation_Group != "Monitoring",] ; db_full <- droplevels(db_full)
db_full <- db_full[db_full$Remove != "yes",] ; db_full <- droplevels(db_full)
# removing aquatic organisms
db_full <- db_full[db_full$System != "Anchialine/Marine",] ; db_full <- droplevels(db_full)
db_full <- db_full[db_full$System != "Groundwater",] ; db_full <- droplevels(db_full)
# removing indirect conservation actions
db_full <- db_full[db_full$Conservation_Group != "Education",] ; db_full <- droplevels(db_full)
db_full <- db_full[db_full$Conservation_Group != "Assessment",] ; db_full <- droplevels(db_full)
db_full <- db_full[db_full$Conservation_Group != "Monitoring",] ; db_full <- droplevels(db_full)
levels(db_full$System)
db_network <- semi_colon_splitter(input1 = db_full$Taxon_Group,
input2 = db_full$Conservation_Action,
names = c("Taxon","Action"))
levels(db_network$Taxon)
levels(db_network$Taxon)[1]  <- "Arthropods"
# Removing not specific and renaming arthropoda
db_network <- db_network[db_network$Taxon != "Not specific",] ; db_network <- droplevels(db_network)
levels(db_network$Taxon)[1]  <- "Arthropods"
levels(db_network$Taxon)
#Sorting
db_network$Taxon <- factor(db_network$Taxon, levels =
c("Bats",levels(db_network$Taxon)[c(-2)]))
Graph_bipartite <- db_network %>%
dplyr::select(Taxon,Action) %>%
table() %>%
igraph::graph_from_incidence_matrix(directed = TRUE) %>%
tidygraph::as_tbl_graph(directed = TRUE)
bipartite_matrix <- db_network %>%
dplyr::select(Taxon,Action) %>%
table()
bipartite_matrix <- matrix(bipartite_matrix, ncol = ncol(bipartite_matrix), dimnames = dimnames(bipartite_matrix))
animal_jaccard <- BAT::beta(bipartite_matrix, abund = TRUE)$Btot
animal_jaccard <- as.matrix(animal_jaccard)
diag(animal_jaccard) <-0
animal_jaccard = 1-animal_jaccard
animal_jaccard_net <- graph_from_adjacency_matrix(animal_jaccard,
mode = "undirected",
weighted = TRUE) %>% as_tbl_graph()
#Add sample size
N <- data.frame(table(db_network$Taxon)) ; colnames(N) <- c("name","N")
N <- cbind(N, Bat = c(TRUE, rep(FALSE,nrow(N)-1)))
animal_jaccard_net <- animal_jaccard_net %>% activate(nodes) %>%  dplyr::left_join(N, by = "name")
animal_jaccard_net <- animal_jaccard_net %>% activate(edges) %>% mutate(Bat = edge_is_from(1))
(plot <- ggraph::ggraph(animal_jaccard_net) +
geom_edge_arc(aes(width = weight,
col = Bat), alpha = 0.3, strength = .1) +
geom_node_point(aes(size = N, col = Bat),
alpha = 0.6,
shape = 19
) +
geom_node_text(aes(label = name), size=6, color="gray10", repel=TRUE, force = 20) +
scale_edge_width_continuous("Jaccard similarity",range=c(0.6,3))+
scale_size_continuous("Sample size",range=c(2,8))+
scale_edge_colour_manual(values = COL)+
scale_colour_manual(values = COL)+
theme_void() + theme(legend.position = "right",legend.direction = "vertical") + guides(colour = "none", edge_colour ="none")  + coord_fixed())
(plot <- ggraph::ggraph(animal_jaccard_net, layout = "kk") +
geom_edge_arc(aes(width = weight,
col = Bat), alpha = 0.3, strength = .1) +
geom_node_point(aes(size = N, col = Bat),
alpha = 0.6,
shape = 19
) +
geom_node_text(aes(label = name), size=6, color="gray10", repel=TRUE, force = 20) +
scale_edge_width_continuous("Similarity",range=c(0.6,3))+
scale_size_continuous("Sample size",range=c(2,8))+
scale_edge_colour_manual(values = COL)+
scale_colour_manual(values = COL)+
theme_void() + theme(legend.position = "right",legend.direction = "vertical") + guides(colour = "none", edge_colour ="none")  + coord_fixed())
(plot <- ggraph::ggraph(animal_jaccard_net, layout = "circle") +
geom_edge_arc(aes(width = weight,
col = Bat), alpha = 0.3, strength = .1) +
geom_node_point(aes(size = N, col = Bat),
alpha = 0.6,
shape = 19
) +
geom_node_text(aes(label = name), size=6, color="gray10", repel=TRUE, force = 20) +
scale_edge_width_continuous("Similarity",range=c(0.6,3))+
scale_size_continuous("Sample size",range=c(2,8))+
scale_edge_colour_manual(values = COL)+
scale_colour_manual(values = COL)+
theme_void() + theme(legend.position = "right",legend.direction = "vertical") + guides(colour = "none", edge_colour ="none")  + coord_fixed())
pdf(file = "Figure/Network.pdf", width = 12, height = 7)
plot
dev.off()
(plot <- ggraph::ggraph(animal_jaccard_net, layout = "circle") +
geom_edge_arc(aes(width = weight,
col = Bat), alpha = 0.3, strength = 0) +
geom_node_point(aes(size = N, col = Bat),
alpha = 0.6,
shape = 19
) +
geom_node_text(aes(label = name), size=6, color="gray10", repel=TRUE, force = 20) +
scale_edge_width_continuous("Similarity",range=c(0.6,3))+
scale_size_continuous("Sample size",range=c(2,8))+
scale_edge_colour_manual(values = COL)+
scale_colour_manual(values = COL)+
theme_void() + theme(legend.position = "right",legend.direction = "vertical") + guides(colour = "none", edge_colour ="none")  + coord_fixed())
(plot <- ggraph::ggraph(animal_jaccard_net, layout = "circle") +
geom_edge_arc(aes(width = weight,
col = Bat), alpha = 0.3, strength = .2) +
geom_node_point(aes(size = N, col = Bat),
alpha = 0.6,
shape = 19
) +
geom_node_text(aes(label = name), size=6, color="gray10", repel=TRUE, force = 20) +
scale_edge_width_continuous("Similarity",range=c(0.6,3))+
scale_size_continuous("Sample size",range=c(2,8))+
scale_edge_colour_manual(values = COL)+
scale_colour_manual(values = COL)+
theme_void() + theme(legend.position = "right",legend.direction = "vertical") + guides(colour = "none", edge_colour ="none")  + coord_fixed())
(plot <- ggraph::ggraph(animal_jaccard_net, layout = "circle") +
geom_edge_arc(aes(width = weight,
col = Bat), alpha = 0.3, strength = .1) +
geom_node_point(aes(size = N, col = Bat),
alpha = 0.6,
shape = 19
) +
geom_node_text(aes(label = name), size=6, color="gray10", repel=TRUE, force = 20) +
scale_edge_width_continuous("Similarity",range=c(0.6,3))+
scale_size_continuous("Sample size",range=c(2,8))+
scale_edge_colour_manual(values = COL)+
scale_colour_manual(values = COL)+
theme_void() + theme(legend.position = "right",legend.direction = "vertical") + guides(colour = "none", edge_colour ="none")  + coord_fixed())
pdf(file = "Figure/Network.pdf", width = 12, height = 7)
plot
dev.off()
(plot <- ggraph::ggraph(animal_jaccard_net, layout = "circle") +
geom_edge_arc(aes(width = weight,
col = Bat), alpha = 0.3, strength = .1) +
geom_node_point(aes(size = N, col = Bat),
alpha = 0.6,
shape = 19
) +
geom_node_text(aes(label = name), size=6, color="gray10", repel=TRUE, force = 20) +
scale_edge_width_continuous("Similarity",range=c(0.6,3))+
scale_size_continuous("Sample size",range=c(2,8))+
scale_edge_colour_manual(values = COL)+
scale_colour_manual(values = COL)+
theme_void() + theme(legend.position = "right",legend.direction = "vertical") + guides(colour = "none", edge_colour ="none"))
pdf(file = "Figure/Network.pdf", width = 12, height = 7)
plot
dev.off()
pdf(file = "Figure/Network.pdf", width = 9, height = 7)
plot
dev.off()
(plot <- ggraph::ggraph(animal_jaccard_net, layout = "randomly") +
geom_edge_arc(aes(width = weight,
col = Bat), alpha = 0.3, strength = .1) +
geom_node_point(aes(size = N, col = Bat),
alpha = 0.6,
shape = 19
) +
geom_node_text(aes(label = name), size=6, color="gray10", repel=TRUE, force = 20) +
scale_edge_width_continuous("Similarity",range=c(0.6,3))+
scale_size_continuous("Sample size",range=c(2,8))+
scale_edge_colour_manual(values = COL)+
scale_colour_manual(values = COL)+
theme_void() + theme(legend.position = "right",legend.direction = "vertical") + guides(colour = "none", edge_colour ="none"))
(plot <- ggraph::ggraph(animal_jaccard_net, layout = "randomly") +
geom_edge_arc(aes(width = weight,
col = Bat), alpha = 0.3, strength = .1) +
geom_node_point(aes(size = N, col = Bat),
alpha = 0.6,
shape = 19
) +
geom_node_text(aes(label = name), size=6, color="gray10", repel=TRUE, force = 20) +
scale_edge_width_continuous("Similarity",range=c(0.6,3))+
scale_size_continuous("Sample size",range=c(2,8))+
scale_edge_colour_manual(values = COL)+
scale_colour_manual(values = COL)+
theme_void() + theme(legend.position = "right",legend.direction = "vertical") + guides(colour = "none", edge_colour ="none"))
(plot <- ggraph::ggraph(animal_jaccard_net, layout = "randomly") +
geom_edge_arc(aes(width = weight,
col = Bat), alpha = 0.3, strength = .1) +
geom_node_point(aes(size = N, col = Bat),
alpha = 0.6,
shape = 19
) +
geom_node_text(aes(label = name), size=6, color="gray10", repel=TRUE, force = 20) +
scale_edge_width_continuous("Similarity",range=c(0.6,3))+
scale_size_continuous("Sample size",range=c(2,8))+
scale_edge_colour_manual(values = COL)+
scale_colour_manual(values = COL)+
theme_void() + theme(legend.position = "right",legend.direction = "vertical") + guides(colour = "none", edge_colour ="none"))
(plot <- ggraph::ggraph(animal_jaccard_net, layout = "randomly") +
geom_edge_arc(aes(width = weight,
col = Bat), alpha = 0.3, strength = .1) +
geom_node_point(aes(size = N, col = Bat),
alpha = 0.6,
shape = 19
) +
geom_node_text(aes(label = name), size=6, color="gray10", repel=TRUE, force = 20) +
scale_edge_width_continuous("Similarity",range=c(0.6,3))+
scale_size_continuous("Sample size",range=c(2,8))+
scale_edge_colour_manual(values = COL)+
scale_colour_manual(values = COL)+
theme_void() + theme(legend.position = "right",legend.direction = "vertical") + guides(colour = "none", edge_colour ="none"))
(plot <- ggraph::ggraph(animal_jaccard_net, layout = "randomly") +
geom_edge_arc(aes(width = weight,
col = Bat), alpha = 0.3, strength = .1) +
geom_node_point(aes(size = N, col = Bat),
alpha = 0.6,
shape = 19
) +
geom_node_text(aes(label = name), size=6, color="gray10", repel=TRUE, force = 20) +
scale_edge_width_continuous("Similarity",range=c(0.6,3))+
scale_size_continuous("Sample size",range=c(2,8))+
scale_edge_colour_manual(values = COL)+
scale_colour_manual(values = COL)+
theme_void() + theme(legend.position = "right",legend.direction = "vertical") + guides(colour = "none", edge_colour ="none"))
(plot <- ggraph::ggraph(animal_jaccard_net, layout = "randomly") +
geom_edge_arc(aes(width = weight,
col = Bat), alpha = 0.3, strength = .1) +
geom_node_point(aes(size = N, col = Bat),
alpha = 0.6,
shape = 19
) +
geom_node_text(aes(label = name), size=6, color="gray10", repel=TRUE, force = 20) +
scale_edge_width_continuous("Similarity",range=c(0.6,3))+
scale_size_continuous("Sample size",range=c(2,8))+
scale_edge_colour_manual(values = COL)+
scale_colour_manual(values = COL)+
theme_void() + theme(legend.position = "right",legend.direction = "vertical") + guides(colour = "none", edge_colour ="none"))
pdf(file = "Figure/Network.pdf", width = 9, height = 7)
(plot <- ggraph::ggraph(animal_jaccard_net, layout = "randomly") +
geom_edge_arc(aes(width = weight,
col = Bat), alpha = 0.3, strength = .1) +
geom_node_point(aes(size = N, col = Bat),
alpha = 0.6,
shape = 19
) +
geom_node_text(aes(label = name), size=6, color="gray10", repel=TRUE, force = 20) +
scale_edge_width_continuous("Similarity",range=c(0.6,3))+
scale_size_continuous("Sample size",range=c(2,8))+
scale_edge_colour_manual(values = COL)+
scale_colour_manual(values = COL)+
theme_void() + theme(legend.position = "right",legend.direction = "vertical") + guides(colour = "none", edge_colour ="none"))
dev.off()
(plot <- ggraph::ggraph(animal_jaccard_net, layout = "gem") +
geom_edge_arc(aes(width = weight,
col = Bat), alpha = 0.3, strength = .1) +
geom_node_point(aes(size = N, col = Bat),
alpha = 0.6,
shape = 19
) +
geom_node_text(aes(label = name), size=6, color="gray10", repel=TRUE, force = 20) +
scale_edge_width_continuous("Similarity",range=c(0.6,3))+
scale_size_continuous("Sample size",range=c(2,8))+
scale_edge_colour_manual(values = COL)+
scale_colour_manual(values = COL)+
theme_void() + theme(legend.position = "right",legend.direction = "vertical") + guides(colour = "none", edge_colour ="none"))
(plot <- ggraph::ggraph(animal_jaccard_net, layout = "gem") +
geom_edge_arc(aes(width = weight,
col = Bat), alpha = 0.3, strength = .1) +
geom_node_point(aes(size = N, col = Bat),
alpha = 0.6,
shape = 19
) +
geom_node_text(aes(label = name), size=6, color="gray10", repel=TRUE, force = 20) +
scale_edge_width_continuous("Similarity",range=c(0.6,3))+
scale_size_continuous("Sample size",range=c(2,8))+
scale_edge_colour_manual(values = COL)+
scale_colour_manual(values = COL)+
theme_void() + theme(legend.position = "right",legend.direction = "vertical") + guides(colour = "none", edge_colour ="none"))
pdf(file = "Figure/Network.pdf", width = 9, height = 7)
plot
dev.off()
(plot <- ggraph::ggraph(animal_jaccard_net, layout = "gem") +
geom_edge_arc(aes(width = weight,
col = Bat), alpha = 0.3, strength = .1) +
geom_node_point(aes(size = N, col = Bat),
alpha = 0.6,
shape = 19
) +
geom_node_text(aes(label = name), size=6, color="gray10", repel=TRUE, force = 20) +
scale_edge_width_continuous("Similarity",range=c(0.6,3))+
scale_size_continuous("Sample size",range=c(3,8), values =c(10,100,400))+
scale_edge_colour_manual(values = COL)+
scale_colour_manual(values = COL)+
theme_void() + theme(legend.position = "right",legend.direction = "vertical") + guides(colour = "none", edge_colour ="none"))
?scale_size_continuous
(plot <- ggraph::ggraph(animal_jaccard_net, layout = "gem") +
geom_edge_arc(aes(width = weight,
col = Bat), alpha = 0.3, strength = .1) +
geom_node_point(aes(size = N, col = Bat),
alpha = 0.6,
shape = 19
) +
geom_node_text(aes(label = name), size=6, color="gray10", repel=TRUE, force = 20) +
scale_edge_width_continuous("Similarity",range=c(0.6,3))+
scale_size_continuous("Sample size",range=c(3,8), breaks =c(10,100,400))+
scale_edge_colour_manual(values = COL)+
scale_colour_manual(values = COL)+
theme_void() + theme(legend.position = "right",legend.direction = "vertical") + guides(colour = "none", edge_colour ="none"))
(plot <- ggraph::ggraph(animal_jaccard_net, layout = "gem") +
geom_edge_arc(aes(width = weight,
col = Bat), alpha = 0.3, strength = .1) +
geom_node_point(aes(size = N, col = Bat),
alpha = 0.6,
shape = 19
) +
geom_node_text(aes(label = name), size=6, color="gray10", repel=TRUE, force = 20) +
scale_edge_width_continuous("Similarity",range=c(0.6,3))+
scale_size_continuous("Sample size",range=c(3,8), breaks =c(10,100,400))+
scale_edge_colour_manual(values = COL)+
scale_colour_manual(values = COL)+
theme_void() + theme(legend.position = "right",legend.direction = "vertical") + guides(colour = "none", edge_colour ="none"))
(plot <- ggraph::ggraph(animal_jaccard_net, layout = "gem") +
geom_edge_arc(aes(width = weight,
col = Bat), alpha = 0.3, strength = .1) +
geom_node_point(aes(size = N, col = Bat),
alpha = 0.6,
shape = 19
) +
geom_node_text(aes(label = name), size=6, color="gray10", repel=TRUE, force = 20) +
scale_edge_width_continuous("Similarity",range=c(0.6,3))+
scale_size_continuous("Sample size",range=c(3,8), breaks =c(10,100,400))+
scale_edge_colour_manual(values = COL)+
scale_colour_manual(values = COL)+
theme_void() + theme(legend.position = "right",legend.direction = "vertical") + guides(colour = "none", edge_colour ="none"))
(plot <- ggraph::ggraph(animal_jaccard_net, layout = "gem") +
geom_edge_arc(aes(width = weight,
col = Bat), alpha = 0.3, strength = .1) +
geom_node_point(aes(size = N, col = Bat),
alpha = 0.6,
shape = 19
) +
geom_node_text(aes(label = name), size=6, color="gray10", repel=TRUE, force = 20) +
scale_edge_width_continuous("Similarity",range=c(0.6,3))+
scale_size_continuous("Sample size",range=c(3,8), breaks =c(10,100,400))+
scale_edge_colour_manual(values = COL)+
scale_colour_manual(values = COL)+
theme_void() + theme(legend.position = "right",legend.direction = "vertical") + guides(colour = "none", edge_colour ="none"))
(plot <- ggraph::ggraph(animal_jaccard_net, layout = "gem") +
geom_edge_arc(aes(width = weight,
col = Bat), alpha = 0.3, strength = .1) +
geom_node_point(aes(size = N, col = Bat),
alpha = 0.6,
shape = 19
) +
geom_node_text(aes(label = name), size=6, color="gray10", repel=TRUE, force = 20) +
scale_edge_width_continuous("Similarity",range=c(0.6,3))+
scale_size_continuous("Sample size",range=c(3,8), breaks =c(10,100,400))+
scale_edge_colour_manual(values = COL)+
scale_colour_manual(values = COL)+
theme_void() + theme(legend.position = "right",legend.direction = "vertical") + guides(colour = "none", edge_colour ="none"))
(plot <- ggraph::ggraph(animal_jaccard_net, layout = "gem") +
geom_edge_arc(aes(width = weight,
col = Bat), alpha = 0.3, strength = .1) +
geom_node_point(aes(size = N, col = Bat),
alpha = 0.6,
shape = 19
) +
geom_node_text(aes(label = name), size=6, color="gray10", repel=TRUE, force = 20) +
scale_edge_width_continuous("Similarity",range=c(0.6,3))+
scale_size_continuous("Sample size",range=c(3,8), breaks =c(10,100,400))+
scale_edge_colour_manual(values = COL)+
scale_colour_manual(values = COL)+
theme_void() + theme(legend.position = "right",legend.direction = "vertical", margin = c(3,3,3,3)) + guides(colour = "none", edge_colour ="none"))
(plot <- ggraph::ggraph(animal_jaccard_net, layout = "gem") +
geom_edge_arc(aes(width = weight,
col = Bat), alpha = 0.3, strength = .1) +
geom_node_point(aes(size = N, col = Bat),
alpha = 0.6,
shape = 19
) +
geom_node_text(aes(label = name), size=6, color="gray10", repel=TRUE, force = 20) +
scale_edge_width_continuous("Similarity",range=c(0.6,3))+
scale_size_continuous("Sample size",range=c(3,8), breaks =c(10,100,400))+
scale_edge_colour_manual(values = COL)+
scale_colour_manual(values = COL)+
theme_void() + theme(legend.position = "right",
legend.direction = "vertical",
plot.margin = unit(c(3, 3, 3, 1), units = , "cm")) + guides(colour = "none", edge_colour ="none"))
(plot <- ggraph::ggraph(animal_jaccard_net, layout = "gem") +
geom_edge_arc(aes(width = weight,
col = Bat), alpha = 0.3, strength = .1) +
geom_node_point(aes(size = N, col = Bat),
alpha = 0.6,
shape = 19
) +
geom_node_text(aes(label = name), size=6, color="gray10", repel=TRUE, force = 20) +
scale_edge_width_continuous("Similarity",range=c(0.6,3))+
scale_size_continuous("Sample size",range=c(3,8), breaks =c(10,100,400))+
scale_edge_colour_manual(values = COL)+
scale_colour_manual(values = COL)+
theme_void() + theme(legend.position = "right",
legend.direction = "vertical",
plot.margin = unit(c(3, 3, 3, 3), units = , "cm")) + guides(colour = "none", edge_colour ="none"))
(plot <- ggraph::ggraph(animal_jaccard_net, layout = "gem") +
geom_edge_arc(aes(width = weight,
col = Bat), alpha = 0.3, strength = .1) +
geom_node_point(aes(size = N, col = Bat),
alpha = 0.6,
shape = 19
) +
geom_node_text(aes(label = name), size=6, color="gray10", repel=TRUE, force = 20) +
scale_edge_width_continuous("Similarity",range=c(0.6,3))+
scale_size_continuous("Sample size",range=c(3,8), breaks =c(10,100,400))+
scale_edge_colour_manual(values = COL)+
scale_colour_manual(values = COL)+
theme_void() + theme(legend.position = "right",
legend.direction = "vertical",
plot.margin = unit(c(3, 3, 3, 3), units = , "cm")) + guides(colour = "none", edge_colour ="none"))
(plot <- ggraph::ggraph(animal_jaccard_net, layout = "gem") +
geom_edge_arc(aes(width = weight,
col = Bat), alpha = 0.3, strength = .1) +
geom_node_point(aes(size = N, col = Bat),
alpha = 0.6,
shape = 19
) +
geom_node_text(aes(label = name), size=6, color="gray10", repel=TRUE, force = 20) +
scale_edge_width_continuous("Similarity",range=c(0.6,3))+
scale_size_continuous("Sample size",range=c(3,8), breaks =c(10,100,400))+
scale_edge_colour_manual(values = COL)+
scale_colour_manual(values = COL)+
theme_void() + theme(legend.position = "right",
legend.direction = "vertical",
plot.margin = unit(c(3, 3, 3, 3), units = , "cm")) + guides(colour = "none", edge_colour ="none"))
(plot <- ggraph::ggraph(animal_jaccard_net, layout = "gem") +
geom_edge_arc(aes(width = weight,
col = Bat), alpha = 0.3, strength = .1) +
geom_node_point(aes(size = N, col = Bat),
alpha = 0.6,
shape = 19
) +
geom_node_text(aes(label = name), size=6, color="gray10", repel=TRUE, force = 20) +
scale_edge_width_continuous("Similarity",range=c(0.6,3))+
scale_size_continuous("Sample size",range=c(3,8), breaks =c(10,100,400))+
scale_edge_colour_manual(values = COL)+
scale_colour_manual(values = COL)+
theme_void() + theme(legend.position = "right",
legend.direction = "vertical",
plot.margin = unit(c(3, 3, 3, 3), units = , "cm")) + guides(colour = "none", edge_colour ="none"))
pdf(file = "Figure/Network.pdf", width = 9, height = 7)
(plot <- ggraph::ggraph(animal_jaccard_net, layout = "gem") +
geom_edge_arc(aes(width = weight,
col = Bat), alpha = 0.3, strength = .1) +
geom_node_point(aes(size = N, col = Bat),
alpha = 0.6,
shape = 19
) +
geom_node_text(aes(label = name), size=6, color="gray10", repel=TRUE, force = 20) +
scale_edge_width_continuous("Similarity",range=c(0.6,3))+
scale_size_continuous("Sample size",range=c(3,8), breaks =c(10,100,400))+
scale_edge_colour_manual(values = COL)+
scale_colour_manual(values = COL)+
theme_void() + theme(legend.position = "right",
legend.direction = "vertical",
plot.margin = unit(c(3, 3, 3, 3), units = , "cm")) + guides(colour = "none", edge_colour ="none"))
dev.off()
(plot <- ggraph::ggraph(animal_jaccard_net, layout = "gem") +
geom_edge_arc(aes(width = weight,
col = Bat), alpha = 0.3, strength = .1) +
geom_node_point(aes(size = N, col = Bat),
alpha = 0.6,
shape = 19
) +
geom_node_text(aes(label = name), size=6, color="gray10", repel=TRUE, force = 20) +
scale_edge_width_continuous("Similarity",range=c(0.6,3))+
scale_size_continuous("Sample size",range=c(3,8), breaks =c(10,100,400))+
scale_edge_colour_manual(values = COL)+
scale_colour_manual(values = COL)+
theme_void() + theme(legend.position = "right",
legend.direction = "vertical",
plot.margin = unit(c(3, 3, 3, 3), units = , "cm")) + guides(colour = "none", edge_colour ="none"))
pdf(file = "Figure/Network.pdf", width = 9, height = 7)
plot
dev.off()
db_full <- db_full[db_full$Taxon_Group != "Not specific",] ; db_full <- droplevels(db_full)
nrow(db_full)
db_full <-
read.csv(
file = "Data/Master_Database_Cave_Conservation.csv",
sep = '\t',
dec = ',',
header = TRUE,
as.is = FALSE
)
db_full <- db_full[db_full$Remove != "yes",] ; db_full <- droplevels(db_full)
# removing aquatic organisms
db_full <- db_full[db_full$System != "Anchialine/Marine",] ; db_full <- droplevels(db_full)
db_full <- db_full[db_full$System != "Groundwater",] ; db_full <- droplevels(db_full)
# removing indirect conservation actions
db_full <- db_full[db_full$Conservation_Group != "Education",] ; db_full <- droplevels(db_full)
db_full <- db_full[db_full$Conservation_Group != "Assessment",] ; db_full <- droplevels(db_full)
db_full <- db_full[db_full$Conservation_Group != "Monitoring",] ; db_full <- droplevels(db_full)
db_full <- db_full[db_full$Taxon_Group != "Not specific",] ; db_full <- droplevels(db_full)
nrow(db_full) ; length(
db_network <- semi_colon_splitter(input1 = db_full$Taxon_Group,
length(unique(levels(db_full))
Education
length(unique(levels(db_full))
))
length(unique(levels(db_full)))
length(unique(levels(db_full$ID)))
db_network <- semi_colon_splitter(input1 = db_full$Taxon_Group,
input2 = db_full$Conservation_Action,
names = c("Taxon","Action"))
# Sample size
nrow(db_network) ; length(unique(levels(db_full$ID)))
citation("BAT")
